update games g
join teams_wc as w1
     on w1.id = g.awayTeamId 
     
join teams_wc as w2 
     on w2.id = g.homeTeamId 
 
join games_fifa as gl
     on gl.awayTeam = w1.name
     and gl.homeTeam = w2.name    
 
left join places as p
     on LOWER(gl.stadium) like CONCAT('%',lower(p.short_name),'%')
set g.placeId = 10
where g.competitionId = 467  
      and g.placeId is null
      
      




select *
from games_wc  g
join games  g2
     on DATE_FORMAT(g2.date, '%d %m %Y %hh' ) = DATE_FORMAT(g.datetime, '%d %m %Y %hh' )
left join places as p
     on LOWER(g.stadium) like CONCAT('%',lower(p.short_name),'%')
     
where length(homeTeam) = 2


update games  g2
join games_wc  g
     on DATE_FORMAT(g2.date, '%d %m %Y %hh' ) = DATE_FORMAT(g.datetime, '%d %m %Y %hh' )
join places as p
     on LOWER(g.stadium) like CONCAT('%',lower(p.short_name),'%')
set g2.placeId = p.id    
where length(homeTeam) = 2




select *
join teams_wc as w1
     on w1.id = g.awayTeamId 
     
join teams_wc as w2 
     on w2.id = g.homeTeamId 
 
join games_fifa as gl
     on gl.awayTeam = w1.name
     and gl.homeTeam = w2.name    
 


where g.competitionId = 467  


      and g.placeId is null
 


update games  g2
join games_wc  g
     on DATE_FORMAT(g2.date, '%d %m %Y %hh' ) = DATE_FORMAT(g.datetime, '%d %m %Y %hh' )
join places as p
     on LOWER(g.stadium) like CONCAT('%',lower(p.short_name),'%')
set g2.placeId = p.id    
where g2.placeId is null



update games  g2 
join games_wc  g
     on DATE_FORMAT(g2.date, '%d %m %Y %hh' ) = DATE_FORMAT(g.datetime, '%d %m %Y %hh' )
left join places as p
     on LOWER(g.stadium) like CONCAT('%',lower(p.short_name),'%')
     
set g2.id_stage = 10   
where g.date >= '2018-07-06'
      and g.date < '2018-07-10'
      
     

      


      
      
      
